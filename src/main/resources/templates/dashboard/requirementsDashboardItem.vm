<script type="text/javascript">
	// initialize
	$webResourceManager.requireResource("de.uhd.ifi.se.decision.management.jira:stylesheet-and-icon-resources")
	$webResourceManager.requireResource("de.uhd.ifi.se.decision.management.jira:requirements-dashboard-resources")
	conDecReport.init("$showDiv")
</script>

<div class="configproject hidden" id="configproject">
   <form class="aui" id="configFormProject">
       <div class="field-group">
           <p>Select Project:</p>
           <select name="project" id="project-input">
           	#foreach($string in $projectNamesMap.keySet())
           		<option value=$projectNamesMap.get($string)>$string</option>
           	#end
           </select>
           <input class="button submit" type="submit" value="Select" id="select-button">
       </div>
   </form>
</div>
<div class="configissuetype hidden" id="configissuetype">
   <form class="aui" id="configFormIssue">
       <div class="field-group">
           <p>Select Issue Type:</p>
           <input type="hidden" name="project" value=$projectKey>
           <select name="issuetype" id="issuetype-input">
           	#foreach($string in $issueTypeNamesMap.keySet())
           		<option value=$issueTypeNamesMap.get($string)>$string</option>
           	#end
           </select>
           <input class="button submit" type="submit" value="Select" id="select-button">
       </div>
   </form>
</div>
<div id="condec-req-dashboard-no-project" class="condec-req-dashboard-no-project hidden">
    $i18n.getText("condec.dashboard.featurebranch.project.selection.not.done")
</div>
	<h1 class="dynamic-content hidden">
		$i18n.getText("condec.jira.project"): $projectName
	</h1>
	
	<div class="dynamic-content hidden" id="dynamic-content-general">
		<h3>General Metrics:</h3>
		<div id="boxplot-CommentsPerJiraIssue" class="notsetyet boxplot"></div>
		<div id="boxplot-CommitsPerJiraIssue" class="notsetyet boxplot"></div>
		<div id="boxplot-DecisionsPerJiraIssue" class="notsetyet boxplot"></div>
		<div id="boxplot-IssuesPerJiraIssue" class="notsetyet boxplot"></div>
		<div id="boxplot-LinkDistanceFromIssue" class="notsetyet boxplot"></div>
		<div id="boxplot-LinkDistanceFromAlternative" class="notsetyet boxplot"></div>
		<div id="boxplot-LinkDistanceFromDecision" class="notsetyet boxplot"></div>
	</div>
	
	<div class="dynamic-content hidden" id="dynamic-content-completeness">
		<h3>Rationale Completeness Metrics</h3>
		<div id="piechartRich-IssuesSolvedByDecision" class="notsetyet piechart"></div>
		<div id="piechartRich-DecisionsSolvingIssues" class="notsetyet piechart"></div>
		<div id="piechartRich-ConArgumentDocumentedForAlternative" class="notsetyet piechart"></div>
		<!--<div id="piechartRich-ConArgumentDocumentedForDecision" class="notsetyet piechart"></div>-->
		<!--<div id="piechartRich-ProArgumentDocumentedForAlternative" class="notsetyet piechart"></div>-->
		<div id="piechartRich-ProArgumentDocumentedForDecision" class="notsetyet piechart"></div>
	</div>
	
	<div class="dynamic-content hidden" id="dynamic-content-inconsistencies">
		<h3>Inconsistencies in Decision Making</h3>
		<div id="piechartRich-IssuesSolvedByManyDecisions" class="notsetyet piechart"></div>
		<!--<div id="piechartRich-DecisionsMadeWithFewerProArguments" class="notsetyet piechart"></div>
		<div id="piechartRich-AlternativesRejectedWithFewerConArguments" class="notsetyet piechart"></div>-->
	</div>
	
	<div class="dynamic-content hidden" id="dynamic-content-basics">
		<h3>Basic Statistics</h3>
		<div id="piechartRich-DecisionDocumentedForSelectedJiraIssue" class="notsetyet piechart"></div>
		<div id="piechartRich-IssueDocumentedForSelectedJiraIssue" class="notsetyet piechart"></div>
		<div id="piechartInteger-RelevantSentences" class="notsetyet piechart"></div>
		<div id="piechartInteger-KnowledgeTypeDistribution" class="notsetyet piechart"></div>
	</div>



<div id="condec-req-dashboard-fatal-error" class="condec-req-dashboard-fatal-error hidden">
    <h1 class="condec-req-dashboard-fatal-error hidden"> $i18n.getText("condec.dashboard.requirements.setup.error") </h1>
</div>

<script type="text/javascript">
	// initialize charts
	#set($title="")
	#foreach ($name in $chartNamesAndPurpose.keySet())
	#set($purpose=$chartNamesAndPurpose.get("$name"))
	#set($data=$chartNamesAndData.get("$name"))
	dataMap = new Map();
	#foreach ($dataName in $data.keySet())
	dataMap.set("$dataName", "$data.get("$dataName")");
	#end
	conDecReport.initializeChart("$name","$title", "$purpose", dataMap);
	#end
	conDecReport.setJiraBaseUrl("$jiraBaseUrl")
</script>


<!-- TODO: replace with AUI-styled or other with plugin consistent overlay implementations -->
<div id="decKnowElementsOverlay" class="hidden overlay">
	<div class="box">
		<h1>
			Involved decision knowledge elements:
		</h1>
		<div id="extractedDecKnowElements" class="contents">
		</div>
	</div>
</div>

<script>

$(document).ready(function() {
  if (!window.conDecReqDashboard) {
      console.error('Could not find required resources!');
      errorNode = document.getElementById("condec-req-dashboard-fatal-error");
      errorNode.classList.remove("hidden");
      return;
  }
  else {
    function projectSelectorOnchange(event) {
        projectName = event.target.value
        selectedOptionIndex = event.target.options.selectedIndex
        selectedOption = event.target.options[selectedOptionIndex]
        conDecReqDashboard.init(projectName,event.target.dataset.uid)
    }
    selectNode = document.getElementById("${selectID}");
    selectNode.addEventListener('change', projectSelectorOnchange);
  }
});
</script>

