$webResourceManager.requireResource("de.uhd.ifi.se.decision.management.jira:stylesheet-and-icon-resources")
$webResourceManager.requireResource("de.uhd.ifi.se.decision.management.jira:dashboard-item-condec-resources")
<style>
.condec-dashboard-selection-section {
    margin:0 1em;
    text-align:center;
}
.condec-dashboard-contents {
    border:2px dashed blue;
    border-radius:1em;
    margin:1em;
    padding:1em;
}
.condec-dashboard-contents.init {
    height:400px;
    min-height:400px;
}
.condec-dashboard-contents.waiting {
    border-color:orange;
}
.condec-dashboard-contents.processing {
    border:1px solid grey;
}
.condec-dashboard-contents.results {
    border:1px solid grey;
}
</style>
<div class="condec-dashboard-selection-section">
  $i18n.getText("condec.dashboard.featurebranch.project.selection.description")
  <select id="${selectID}" class="condec-dashboard-select"
    data-uid="${dashboardUID}"
  >
    <option value="">
    $i18n.getText("condec.dashboard.featurebranch.project.selection.pickone")
    </option>
	#foreach ($key in $projectNamesMap.keySet())
	    <option value="$key"
	    data-gituri="$projectGitMap.get($key)"
	    >
		$key - $projectNamesMap.get($key)
		</option>
	#end
  </select>
</div>

<div id="condec-branches-dashboard-contents-data-error${dashboardUID}" class="condec-dashboard-contents error hidden">
$i18n.getText("condec.dashboard.featurebranch.project.data.error")
</div>


<div id="condec-branches-dashboard-no-project${dashboardUID}" class="condec-dashboard-contents init">
    $i18n.getText("condec.dashboard.featurebranch.project.selection.not.done")
</div>


<div id="condec-branches-dashboard-processing${dashboardUID}" class="condec-dashboard-contents waiting hidden">
    $i18n.getText("condec.dashboard.featurebranch.project.processing")
</div>


<div id="condec-branches-dashboard-fatal-error${dashboardUID}" class="condec-dashboard-contents error hidden">
    $i18n.getText("condec.dashboard.featurebranch.setup.error")
</div>


<div id="condec-branches-dashboard-nogit-error${dashboardUID}" class="condec-dashboard-contents error hidden">
    $i18n.getText("condec.dashboard.featurebranch.project.nogit")
</div>


<div id="condec-branches-dashboard-contents-container${dashboardUID}" class="condec-dashboard-contents results hidden">
	<div id="piechartRich-QualityStatusForBranches${dashboardUID}" class="notsetyet piechart"></div>
	<div id="piechartRich-ProblemTypesInBranches${dashboardUID}" class="notsetyet piechart"></div>
	<div id="piechartRich-BranchesPerIssue${dashboardUID}" class="notsetyet piechart"></div>
	<div id="boxplot-IssuesPerBranch${dashboardUID}" class="notsetyet piechart"></div>
	<div id="boxplot-DecisionsPerBranch${dashboardUID}" class="notsetyet piechart"></div>
	<div id="boxplot-AlternativesPerBranch${dashboardUID}" class="notsetyet piechart"></div>
	<div id="boxplot-ProsPerBranch${dashboardUID}" class="notsetyet piechart"></div>
	<div id="boxplot-ConsPerBranch${dashboardUID}" class="notsetyet piechart"></div>
</div>
<script>

/* look up https://developer.mozilla.org/en-US/docs/Web/API/Window/load_event
    window.addEventListener('load'.. does not work well for gadgets.. observed with Firefox
    using jquery instead, which manages gadgets.
 */
$(document).ready(function() {
  if (!window.conDecBranchesDashboard) {
      console.error('Could not find required resources!');
      errorNode = document.getElementById("condec-branches-dashboard-fatal-error${dashboardUID}");
      errorNode.classList.remove("hidden");
      return;
  }
  else {
    function projectSelectorOnchange(event) {
        projectName = event.target.value
        selectedOptionIndex = event.target.options.selectedIndex
        selectedOption = event.target.options[selectedOptionIndex]
        conDecBranchesDashboard.init(projectName,event.target.dataset.uid, selectedOption.dataset.gituri)
    }
    selectNode = document.getElementById("${selectID}");
    selectNode.addEventListener('change', projectSelectorOnchange);
  }
});
</script>
<!-- TODO refactor ids, classes here and in report page for the overlay -->
<div id="decKnowElementsOverlay" class="hidden overlay">
	<div class="box">
		<h1>
			Involved feature task branch(es):
		</h1>
		<div id="extractedDecKnowElements" class="contents">
		</div>
	</div>
</div>

